<!DOCTYPE html><html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="/css/about.css">

    <title>RadioLook - Относно</title>
  </head>
  
  <body>
			<nav class="navbar navbar-expand-md navbar-dark bg-dark">
		  <a class="navbar-brand" href="/"><img src="/logo.png" width="30" height="30" class="d-inline-block align-top" alt=""> RadioLook</a>
		  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		  </button>

		  <div class="collapse navbar-collapse" id="navbarsExampleDefault">
			<ul class="navbar-nav mr-auto">
			  <li class="nav-item">
				<a class="nav-link" href="/">Начало</a>
			  </li>
			  <li class="nav-item">
				<a class="nav-link" href="/radios">Списък</a>
			  </li>
			  <li class="nav-item dropdown">
				<a class="nav-link dropdown-toggle" href="#" id="dropdown01" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Радиа</a>
				<div id="radios-dropdown" class="dropdown-menu" aria-labelledby="dropdown01"><a class="dropdown-item" href="/radio/avtoradio">Авторадио</a>
<a class="dropdown-item" href="/radio/bgradio">БГ Радио</a>
<a class="dropdown-item" href="/radio/novanews">Нова Нюз</a>
<a class="dropdown-item" href="/radio/radioenergy">Радио NRJ</a>
<a class="dropdown-item" href="/radio/radio1">Радио 1</a>
<a class="dropdown-item" href="/radio/radio1rock">Радио 1 Рок</a>
<a class="dropdown-item" href="/radio/radioveronika">Радио Вероника</a>
<a class="dropdown-item" href="/radio/nrj90s">Радио NRJ 90s</a>
<a class="dropdown-item" href="/radio/radionova">Радио Nova</a>
<a class="dropdown-item" href="/radio/radiocity">Радио City</a>
<a class="dropdown-item" href="/radio/bgestrada">Радио БГ Естрада</a>
</div>
			  </li>
			  <li class="nav-item">
				<a class="nav-link" href="/feedback">Контакт</a>
			  </li>
			  <li class="nav-item active">
				<a class="nav-link" href="/about">Относно<span class="sr-only">(current)</span></a>
			  </li>
			</ul>

		  </div>
		</nav>
	
	<main role="main" class="container">	
	

		
<!-- 		<div class="jumbotron jumbotron-fluid">
			<div class="container">
				<h1 class="display-4">RadioLook - Виж това, което слушаш</h1>
				<p class="lead">Информация за българските радиа и парчетата, които пускат</p>
			</div>
		</div> -->
		

		  <div class="jumbotron jumbotron-fluid">
			<div class="container">
				<div class="row">
					<div class="col">
						<a class="tu-url" target="_blank" href="https://tu-sofia.bg"><img id="tu-logo" class="rounded float-none float-md-right" src="/tu-logo.png" width="140" height="140"></a>
					</div>
					<div id="header-col" class="col-sm-8 text-left">
						<h1 class="display-5">Технически Университет – София</h1>
						<p class="lead">Факултет Приложна Математика и Информатика <br> Катедра Информатика</p>
					</div>
				</div>
			</div>		

		</div>
		
		<div class="blog-post">
			<h1 class="text-center">КУРСОВ ПРОЕКТ</h1>

			<p class="top"><strong>Създаване на динамична интернет страница, състояща се от клиентска част </strong><strong>(</strong><strong>написана на </strong><strong>HTML, CSS </strong><strong>и </strong><strong>JavaScript) </strong><strong>и сървърна част, написана на </strong><strong>Node.js</strong><strong>.</strong></p>
			<p class="top"><strong>Имена на студента: Тодор Иванов Пъков</strong></p>
			<p class="top"><strong>Факултетен номер, група: 471218003, 78 гр.</strong></p>
			<hr>
			<div id="contents">
				<h2>Съдържание:</h2>
				<ol>
					<li><a href="#one">Проучване на проблемната област</a></li>
					<li><a href="#two">Цел и задачи на проекта</a></li>
					<li><a href="#three">Софтуерна разработка</a></li>
					<li><a href="#four">Програмна реализация</a></li>
					<li><a href="#five">Експериментални резултати</a></li>
				</ol>
			</div>
			
			
			<ol>
				<li>
					<p></p><h2 id="one">Проучване на проблемната област</h2>Предметната област е свързана със създаването на <strong>динамична интернет страница</strong>, представяща подробна <strong>информация за набор от интернет радиа</strong>. Тази информация включва текущо изпълняваната песен, обложката на албума (ако е налична), броя на текущите слушатели, максималния брой слушатели за съответното радио. Предоставя се възможност за слушане на stream-овете на радиата както чрез външен плейър, така и чрез онлайн такъв, достъпен на самия сайт.<p></p> 
					<p>Като допълнителна функционалност са включени форма за контакт, чрез която потребителите могат да изпращат своите въпроси и предложения, отделна страница следяща текущия статус на използваните за извличане на информацията сървъри, както и страница, посветена на пълното описание на проекта. Съдържанието на уеб страницата се обновява динамично, като това става автоматично през определен период от време. Извлечената информация съхранява в база данни.</p>
				</li>
				<li>
					<p></p><h2 id="two">Цел и задачи на проекта</h2>Да се представят част от възможностите на библиотеката <strong>Boostrap</strong>, улесняваща оформянето на дизайна на клиентската част, както и да се представи наборът от инструменти, предлагани от средата за разработка <strong>Express.js</strong>, при оформянето на сървърната част на сайта (т.нар. back end). Да се изследва функционалността на релационната база данни <strong>SQLite</strong>, при която цялата база данни е съсредоточена в един единствен файл, и основанията за нейното използване в приложения, изискващи едновременен достъп.<p></p>
				</li>
				<li>
					<p></p><h2 id="three">Софтуерна разработка</h2>Софтуерната разработка се състои от две части - сървърна част (back end) и клиентска част (front end).<p></p>
					<p><strong>Клиентската част</strong> представлява съвкупността от динамично генерираните <strong>HTML</strong> документи, <strong>CSS</strong> и <strong>JavaScript</strong> код, които се визуализират от уеб-браузъра на потребителя и съставляват потребителския интерфейс на приложението</p>
					<p>Сайтът е изграден от следните страници: основна страница (<strong>index.html</strong>), която играе ролята на начална страница и съдържа информацията за текущото състояние и времето на последен достъп до сървърите и базата данни, като информацията се обновява динамично, без да е нужно действие от страна на потребителя.</p>
					<p><strong>RadioList.html</strong>, на която е разположена таблица с информация за достъпните радиа като лого, уебсайт, броят на текущите слушатели, максималният брой слушатели, текущо изпълнявани песни, както и линкове за сваляне на .m3u stream-овете за слушане във външен плейър.</p>
					<p>Всяко едно от радиата има и своя собствена страница, изградена на базата на <strong>radioPage.html</strong>. Тази страница визуализира обложката на текущата песен и предоставя възможност за слушане на съответното ради директно чрез вградения HTML5 радио плейър <strong>Muses</strong>. Достъпна е още и таблица с последните 10 песни, като потребителят може да се върне и по-назад в историята. Налице са удобни линкове за бързо търсене на дадена песен в платформи като <strong>Google</strong>, <strong>YouTube</strong>, <strong>Genius</strong> и <strong>Spotify</strong>. Автоматично се прави проверка дали текущата песен вече не е различна. В случай, че това е така, тя се променя динамично без да се изисква обновяване на страницата.</p>
					<p>На страницата <strong>feedback.html</strong> потребителите могат да изпращат своята обратна връзка, използвайки представената форма. Съобщението се изпраща с <strong>AJAX POST</strong> заявка до сървъра, където се обработва.</p>
					<p>Страницата <strong>about.html</strong> съдържа подробно описание на самия проект.</p>
					<p>Основната част от дизайна на страниците е изградена с помощта на средата <strong>Bootstrap</strong>, която съдържа набор от инструменти за създаване и оформяне на уеб-сайтове. Всяка от страниците се състои от навигационна лента (<strong>Navbar</strong>) в горната си част, даваща достъп до останалите, както и т.нар. <strong>Footer</strong> в долната част, където е разположена информация за автора.</p>
					<p>За самото съдържание са използвани редица елементи, предлагани от <strong>Bootstrap</strong>, като <strong>Cards</strong>, <strong>Modals</strong>, <strong>Jumbotrons</strong>, <strong>Popovers</strong>. Отделните елементи са подредени в редове и колони спрямо т.нар. <strong>Grid Layout</strong>, благодарение на който дизайнът на страницата става динамичен и може да се променя според размера на екрана на устройство на потребителя, изглеждайки еднакво добре както на десктоп компютри, така и на мобилни телефони.</p>
					<p>Към някои от страниците са свързани и .css файлове, чрез които се осъществява допълнителна персонализация, като промяна на цвета и подравняването на определени елементи и осигуряване на отстояния (margins).</p>
					<p><strong>Сървърната част</strong> обработва получените от потребителя данни, отговаря на неговите заявки и извлича необходимата за правилното функциониране на сайта информация. Тя е изградена на <strong>Node.js</strong>. Със своята задвижвана от събития (event-driven) архитектура и неблокираща входно-изходна система, Node.js значително оптимизира производителността и мащабируемостта на дадена програма.</p>
					<p>В допълнение към основната node.js функционалност, проектът използва и няколко външни пакета, които я разширяват. Сред тях са <strong>Express.js</strong> – уеб фреймуърк (технологична работна рамка), който улеснява създаването на комплексни динамични уеб приложения.</p>
					<p>Express използва т.нар. мидълуер функции (<strong>middleware</strong>). Това са функции, имащи достъп до обекта на заявката (<strong>request object (req)</strong>) и обектът на отговора (<strong>response object (res)</strong>). Тези функции могат да изпълняват всякакъв код, да правят промени по двата обекта, да прекратяват цикъла от заявки и отговори и да извикват следващата мидълуер функция в стека.</p>
					<p>Примери за такива функции, използвани в проекта, са <strong>body-parser</strong> – middleware за Express.js, който позволява parse-ване на тялото на заявка и <strong>serve-favicon</strong> – друг middleware, за предоставяне на иконка (favicon) за страниците на сайта.</p>
					<p>Други външни пакети са <strong>jsdom</strong>, който дава възможност за работа с <strong>DOM</strong> обекти в node.js, <strong>nodemailer</strong> – модул за изпращане на имейли, <strong><span>sqlite3</span></strong><span> – </span>модул, осъществяващ връзка и позволяващ работа с SQLite база данни и <strong>sqlite</strong> – разширение на sqlite3 модула, добавящо т.нар. обещания (<strong>promises</strong>), представени за първи път в <strong>ES6</strong> (шестата версия на ECMAScript).</p>
					<p><strong>server.js</strong> – Тук се инициализира Express приложението (обектът <strong>app</strong>). С негова помощ се дефинира поведението на сървъра при различните видове заявки, като в зависимост от типа на заявката и адреса и се генерира различен отговор. Тук става и самото стартиране на сървъра.</p>
					<p><strong>dataHandler.js </strong>– В този файл се осъществява голяма част от работата с данните. При стартирането на сървъра се установява връзка с базата данни, извлича се информация за наличните радиа (<strong><em>getRadioNamesFromDB()</em></strong>) и се изтеглят данните от <strong>IceCast</strong> (<strong><em>getIcecastData()</em></strong>) и <strong>Ме</strong><strong>taCast</strong> (<strong><em>getMetacastData()</em></strong>) сървърите. Те предоставят нужната на уебсайта информация. Извличането става чрез <strong>HTTP GET</strong> заявки, а получената информация след подходяща обработка се съхранява в базата данни за бъдещо ползване (<strong><em>persistIcecastData(), persistMetacastData()</em></strong>). Част от нея остава налична и в паметта за по-бърз достъп. Поддържа се информация относно статуса на достъпваните сървъри, както и времето на последния опит за достъп. Тази информация може да бъде предоставена на клиента в отговор на съответната заявка (<strong><em>getServiceStatus(response)</em></strong>).</p>
					<p>Тук е разположена и частта от кода, която се занимава с обработката на получената от потребителите обратна връзка (<strong><em>processFeedback(feedback)</em></strong>). Тя се съхранява в базата данни. При наличие на файл <strong>secrets.js</strong> в основната директория, съдържащ обект с информация за даден STMP сървър и имейл акаунт, е възможно (чрез модула nodemailer) изпращането на имейл на собственика на сайта при получена обратна връзка, съдържащ информация за потребителя и неговото съобщение.</p>
					<p>Друга функция отговаря на AJAX заявката за текущата песен, изпълнявана по дадено радио, като изпраща данните за песента, под формата на JSON обект (<strong><em>updateCurrentSong(token)</em></strong>). Самата проверка дали песента се е променила се осъществява от клиентската страна.</p>
					<p>Функцията <strong>loadMoreSongs(token, tableRows)</strong>, както подсказва и името ѝ, се използва, когато бъде получена заявка за визуализиране на по старите песни, изпълнени по дадено радио, в таблицата, разположена на неговата страница. Тя извлича нужните песни от базата данни, като изместването (offset) се пази от клиентската страна, тъй като то е уникално за всеки потребител и при всеки различен брой натискания на бутона за зареждане на още песни. Осъществява се конструиране на новата таблица, която да се присъедини, към вече заредената на сайта, с помощта на jsdom и шаблона за това как изглежда всеки ред от таблицата, разположен в <strong>songlistTableLayout.html</strong>. Финалният DOM обект се сериализира и изпраща като отговор на заявката.</p>
					<p>Третият основен файл, съдържащ сървърния код, е <strong>htmlConstructor.js</strong>. Тук са разположени функциите, които конструират HTML страниците, връщани като отговор на заявките на потребителя.</p>
					<p>Функцията <strong>constructHTML(fileName, response, regExRadioNameCapture)</strong> играе ролята на маршрутизатор (<strong>router</strong>). В зависимост от параметрите с които е извикана от middleware-ите на Express.js извиква отделните функции, конструиращи различните страници на сайта.</p>
					<p>Всяка една от тези функции отваря страницата, намираща се в директорията на проекта, както и някои помощни .html файлове, променя съдържанието ѝ и я връща като отговор, като заедно с това презаписва старото локално копие.</p>
					<p><strong>constructIndexPage(fileName, response)</strong> изготвя началната страница, като обновява текущото състояние на сървърите и времето на последния опит за достъп. Цветът на елеменитете Cards от Bootstrap също се променя динамично, чрез модифициране на техния клас.</p>
					<p><strong>constructRadiosPage(fileName, response)</strong> се грижи за създаването на страницата, съдържаща таблица с кратка информация за наличните радиа. За целта се извършва извличане на информацията от базата данни и обновяване на наличната във файла таблица. Модифицират се връзките за търсене на песента във външни услуги.</p>
					<p><strong>constructConcreteRadioPage(fileName, response, regExRadioNameCapture)</strong> се занимава със генерирането на конкретната страница за дадено радио. В зависимост от радиото, за което е направена заявката, се модифицира името на страницата, както и необходимите данни – текуща песен, изображение, лого, уебсайт и т.н. Тук става и образуването на таблицата с последно изпълняваните песни, която може да бъде разширена чрез заявка от потребителя.</p>
					<p><strong>constructAboutPage(fileName, response)</strong> и <strong>constructFeedbackPage(fileName, response) </strong>са ангажирани респективно със страниците за информация и за обратна връзка. Поради статичния характер на тези две страници, функциите са по-опростени. Те извличат съответния локален .html файл,&nbsp; актуализират списъка с наличните радиа в навигационното меню и изпращат страницата без да правят други промени.</p>
					<p>Самото актуалазиране на списъка с радиа се извърша от функцията <strong>addRadiosToNavbar(dom)</strong>. То се изпълнява и в останалите функции и с негова помощ не се допуска потребителят да достъпи радиостанция, която поради една или друга причина не налична в дадения момент.</p>
					<p>При своята операция, сървърът работи с количество данни, които трябва да бъдат съхранявани. За тяхната персистентност се използва софтуерът <strong>SQLite</strong>. Това е релационна база данни с отворен код, поддържаща стандарта SQL. Тя е реализирана като библиотека към приложения, а не като самостоятелно работеща програма.</p>
					<p>Концепцията на SQLite е цялата база да бъде съсредоточена в един-единствен файл. В случая това е файлът <strong>radio_look.db</strong>, който съдържа три таблици: <strong><span>radio_info</span></strong>, носеща информацията за всички налични радиа, <strong>song_list</strong>, състояща се от изпълняваните по радиата песни и някои детайли свързани с тях, както и <strong>user_feedback</strong>, където се поместват получените от потребителите съобщения.</p>
				</li>
				<li>
					<p></p><h2 id="four">Програмна реализация</h2>Всички файлове, които са част от проекта, могат да бъдат свободно достъпени от неговото хранилище в GitHub, налично <a href="https://github.com/trpakov/RadioLookProject"><strong>ТУК</strong></a>.<p></p>
				</li>
				<li>
					<p></p><h2 id="five">Експериментални резултати</h2>Node.js предоставя удобна среда за разработка на сървърни приложения. Неговите простота и гъвкавост увеличават значително продуктивността, а големият брой библиотеки води до по-голямо удобство от страна на разработчиците.<p></p>
					<p>Платформата Bootstrap комбинира HTML, CSS и &nbsp;JavaScript и значително улеснява и ускорява създаването на почти всички елементи от дизайна, необходим за съответния проект. Тя е съвместима с всички основни браузъри, като отделя специално внимание на мобилните устройства, предлагайки инструменти за изграждане на адаптивен дизайн, определящ начина, по който елементите се подреждат на страницата при различните резолюции.</p>
					<p>SQLite е изключително бърза и надеждна база данни без сървърен процес. Тя е удобна, не изисква конфигурация, работи под всякакви платформи. Подходяща е както за по-малки уеб приложения, така и за големи проекти. SQLite работи чудесно като база данни за малки и средни по големина уебсайтове. Количеството трафик, с което може да се справи зависи от това до каква степен сайтът използва базата данни. Според официалния сайт на проекта, всеки сайт имащ по-малко от 100 хиляди посещения на ден, не би имал проблеми, като са правени и демонстрации с 10 пъти по голям трафик. Създателите дават следния пример – през 2015, техния сайт получава около 400-500 хиляди HTTP заявки на ден, като от тях близо 15-20% са за динамични страници, достъпващи базата данни. При тях динамичното съдържание използва около 200 SQL твърдения (statements). Сървърът се изпълнява на виртуална машина, споделяща физически сървър с още 23 други, и въпреки това средното натоварването остава под 0.1 през по-голямата част от времето.</p>			
				</li>
			</ol>
					
			
		</div>
		
	</main>
	  
	
	<footer class="page-footer font-small bg-dark">
		<div class="footer-copyright text-center text-light py-2 text-monospace font-weight-bold">© 2020 |
			<a href="#" target="_blank" class="text-light">trpakov</a>
		</div>
	</footer>
	


    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
  
</body></html>